version: 0.2

phases:
  install:
    runtime-versions:
      docker: 19
  pre_build:
    commands:
      - docker -v
      - docker-compose -v
      - groups
      - echo Logging in to Amazon ECR...
      - $(aws ecr get-login --no-include-email --region $AWS_DEFAULT_REGION)
      - docker pull 391634500132.dkr.ecr.eu-central-1.amazonaws.com/laravel_8:latest
      - printenv | sed 's/=\(.*\)/="\1"/' > .env
      - docker-compose up -d
  build:
    commands:
      - docker container exec -it docker-compose_web_1 pwd
      - docker container exec -it docker-compose_web_1 ls -la /var/www/html
      - echo "test build"

